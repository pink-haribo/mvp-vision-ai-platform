# Platform Dataset Format: í•µì‹¬ ì„¤ê³„ ê²°ì • ì‚¬í•­

**Date:** 2025-01-04
**Status:** Design Decision Document

---

## ğŸ“‹ ëª©ì°¨

1. [ê²°ì • ì‚¬í•­ ìš”ì•½](#ê²°ì •-ì‚¬í•­-ìš”ì•½)
2. [ìŸì  1: ë‹¨ì¼ vs ë¶„ì‚° Annotation](#ìŸì -1-ë‹¨ì¼-vs-ë¶„ì‚°-annotation)
3. [ìŸì  2: ìƒëŒ€ ê²½ë¡œ vs ì ˆëŒ€ ê²½ë¡œ](#ìŸì -2-ìƒëŒ€-ê²½ë¡œ-vs-ì ˆëŒ€-ê²½ë¡œ)
4. [ì¢…í•© ë¹„êµ](#ì¢…í•©-ë¹„êµ)
5. [ìµœì¢… ê²°ì • ë° ê·¼ê±°](#ìµœì¢…-ê²°ì •-ë°-ê·¼ê±°)
6. [í•˜ìœ„ í˜¸í™˜ì„± í•´ê²° ë°©ì•ˆ](#í•˜ìœ„-í˜¸í™˜ì„±-í•´ê²°-ë°©ì•ˆ)

---

## ê²°ì • ì‚¬í•­ ìš”ì•½

| ìŸì  | v0.9 (Legacy) | v1.0 (Platform) | ê²°ì • |
|------|---------------|-----------------|------|
| **Annotation êµ¬ì¡°** | ë¶„ì‚°í˜• (íŒŒì¼ë³„) | í†µí•©í˜• (ë‹¨ì¼ íŒŒì¼) | âœ… **ë‹¨ì¼ íŒŒì¼** (annotations.json) |
| **ê²½ë¡œ ë°©ì‹** | ì ˆëŒ€ ê²½ë¡œ | ìƒëŒ€ ê²½ë¡œ | âœ… **ìƒëŒ€ ê²½ë¡œ** (Cloud í˜¸í™˜) |
| **í•˜ìœ„ í˜¸í™˜** | N/A | Auto-migration + legacy ë°±ì—… | âœ… **100% ë³´ì¥** |

---

## ìŸì  1: ë‹¨ì¼ vs ë¶„ì‚° Annotation

### ğŸ“Š ë¹„êµí‘œ

| í•­ëª© | ë¶„ì‚°í˜• (v0.9) | í†µí•©í˜• (v1.0) |
|------|---------------|---------------|
| **íŒŒì¼ êµ¬ì¡°** | Nê°œ íŒŒì¼ (imageë‹¹ 1ê°œ) | 1ê°œ íŒŒì¼ (ì „ì²´ í†µí•©) |
| **ì˜ˆì‹œ** | `labels/img001.json`<br/>`labels/img002.json`<br/>...<br/>`labels/img1000.json` | `annotations.json` |
| **íŒŒì¼ ìˆ˜** | 1 summary + 1000 labels = **1,001ê°œ** | **1ê°œ** |
| **ìŠ¤í† ë¦¬ì§€** | ~1.5MB (1000 images) | ~800KB (ì••ì¶• íš¨ê³¼) |
| **ë¡œë”© ì†ë„** | ëŠë¦¼ (1000ê°œ íŒŒì¼ read) | ë¹ ë¦„ (1ê°œ íŒŒì¼ read) |
| **ìˆ˜ì •** | ì´ë¯¸ì§€ 1ê°œ ìˆ˜ì • ì‹œ í•´ë‹¹ íŒŒì¼ë§Œ ìˆ˜ì • | annotations.json ì „ì²´ ìˆ˜ì • |
| **ê²€ìƒ‰** | ì „ì²´ ê²€ìƒ‰ ì‹œ 1000ê°œ íŒŒì¼ íŒŒì‹± | 1ê°œ íŒŒì¼ë§Œ íŒŒì‹± |
| **ì¸ë±ì‹±** | ì–´ë ¤ì›€ (summary ë³„ë„ ìœ ì§€ í•„ìš”) | ì‰¬ì›€ (built-in statistics) |
| **Cloud ì—…ë¡œë“œ** | ëŠë¦¼ (1000ë²ˆ PUT) | ë¹ ë¦„ (1ë²ˆ PUT) |
| **ë²„ì „ ê´€ë¦¬** | ë³µì¡ (ì–´ë–¤ íŒŒì¼ ë³€ê²½?) | ê°„ë‹¨ (content_hash 1ê°œ) |
| **ë™ì‹œ í¸ì§‘** | ì¶©ëŒ ì ìŒ (íŒŒì¼ë³„ ë…ë¦½) | ì¶©ëŒ ê°€ëŠ¥ (ì „ì²´ íŒŒì¼) |

---

### ìƒì„¸ ë¶„ì„

#### A. ì„±ëŠ¥

**ë¶„ì‚°í˜• (v0.9)**
```python
# 1000ê°œ ì´ë¯¸ì§€ ë¡œë”©
for img in range(1000):
    with open(f"labels/img{img:03d}.json") as f:
        label = json.load(f)

# íŒŒì¼ I/O: 1000ë²ˆ
# ì´ ì‹œê°„: ~2-3ì´ˆ (ë¡œì»¬), ~30-60ì´ˆ (ë„¤íŠ¸ì›Œí¬)
```

**í†µí•©í˜• (v1.0)**
```python
# 1000ê°œ ì´ë¯¸ì§€ ë¡œë”©
with open("annotations.json") as f:
    data = json.load(f)

for img in data['images']:
    annotation = img['annotation']

# íŒŒì¼ I/O: 1ë²ˆ
# ì´ ì‹œê°„: ~100-200ms (ë¡œì»¬), ~500ms-1s (ë„¤íŠ¸ì›Œí¬)
```

**ì„±ëŠ¥ ë¹„êµ:**
- ë¡œì»¬: **10-30ë°° ë¹ ë¦„**
- ë„¤íŠ¸ì›Œí¬ (R2): **30-60ë°° ë¹ ë¦„**

---

#### B. ìŠ¤í† ë¦¬ì§€ íš¨ìœ¨

**ë¶„ì‚°í˜• (v0.9)**
```json
// labels/img001.json (ë°˜ë³µë˜ëŠ” ë©”íƒ€ë°ì´í„°)
{
  "version": "0.9",              // â† ëª¨ë“  íŒŒì¼ì— ë°˜ë³µ
  "task_type": "det",            // â† ëª¨ë“  íŒŒì¼ì— ë°˜ë³µ
  "imageHeight": 1080,           // â† ê°œë³„ ì´ë¯¸ì§€ë§ˆë‹¤
  "imageWidth": 1920,            // â† ê°œë³„ ì´ë¯¸ì§€ë§ˆë‹¤
  "imageDepth": 3,               // â† ëª¨ë“  íŒŒì¼ì— ë°˜ë³µ
  "shapes": [...]
}

// 1000ê°œ íŒŒì¼ Ã— ~1.5KB = 1.5MB
```

**í†µí•©í˜• (v1.0)**
```json
// annotations.json (ê³µí†µ ë©”íƒ€ë°ì´í„° 1ë²ˆë§Œ)
{
  "format_version": "1.0",       // â† 1ë²ˆë§Œ
  "task_type": "object_detection", // â† 1ë²ˆë§Œ
  "classes": [...],              // â† 1ë²ˆë§Œ

  "images": [
    {
      "id": 1,
      "file_name": "img001.jpg",
      "width": 1920,             // â† ê°œë³„ ì´ë¯¸ì§€ë§ˆë‹¤
      "height": 1080,
      "annotations": [...]
    }
  ]
}

// 1ê°œ íŒŒì¼ Ã— ~800KB = 800KB
```

**ìŠ¤í† ë¦¬ì§€ ë¹„êµ:**
- **47% ì ˆì•½** (1.5MB â†’ 800KB)
- JSON ì••ì¶• íš¨ê³¼ (ì¤‘ë³µ í‚¤ ì œê±°)

---

#### C. Cloud Storage ìµœì í™”

**R2 API í˜¸ì¶œ ë¹„ìš©**

| ì‘ì—… | ë¶„ì‚°í˜• (v0.9) | í†µí•©í˜• (v1.0) |
|------|---------------|---------------|
| **ì—…ë¡œë“œ** | 1000 Ã— PUT = **1000 requests** | 1 Ã— PUT = **1 request** |
| **ë‹¤ìš´ë¡œë“œ** | 1000 Ã— GET = **1000 requests** | 1 Ã— GET = **1 request** |
| **ìˆ˜ì •** | 1 Ã— PUT (í•´ë‹¹ íŒŒì¼ë§Œ) | 1 Ã— PUT (ì „ì²´) |
| **ê²€ìƒ‰** | 1000 Ã— GET â†’ íŒŒì‹± | 1 Ã— GET â†’ íŒŒì‹± |

**ë¹„ìš© ì˜ˆì‹œ (Cloudflare R2)**
- Class A (PUT): $4.50 / million requests
- Class B (GET): $0.36 / million requests

```
ë¶„ì‚°í˜•:
  - ì—…ë¡œë“œ: 1000 Ã— $0.0000045 = $0.0045
  - ë‹¤ìš´ë¡œë“œ: 1000 Ã— $0.00000036 = $0.00036
  - ì´: $0.00486 (1íšŒ)

í†µí•©í˜•:
  - ì—…ë¡œë“œ: 1 Ã— $0.0000045 = $0.0000045
  - ë‹¤ìš´ë¡œë“œ: 1 Ã— $0.00000036 = $0.00000036
  - ì´: $0.0000081 (1íšŒ)

ì ˆì•½: 99.8%
```

ì‚¬ìš©ì 1,000ëª…ì´ ê°ê° ë°ì´í„°ì…‹ 10ë²ˆ ì—…ë°ì´íŠ¸:
- ë¶„ì‚°í˜•: **$48.6**
- í†µí•©í˜•: **$0.081**

---

#### D. ë²„ì „ ê´€ë¦¬

**ë¶„ì‚°í˜• (v0.9)**
```
ë²„ì „ 1: labels/img001.json (ìˆ˜ì • ì „)
ë²„ì „ 2: labels/img001.json (ìˆ˜ì • í›„)
        labels/img500.json (ì¶”ê°€)

ë¬¸ì œ:
- ì–´ë–¤ íŒŒì¼ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ì¶”ì  ì–´ë ¤ì›€
- content_hash ê³„ì‚° ë³µì¡ (ëª¨ë“  íŒŒì¼ hash í•„ìš”)
- Git ì¶©ëŒ ë§ìŒ (1000ê°œ íŒŒì¼)
```

**í†µí•©í˜• (v1.0)**
```
ë²„ì „ 1: annotations.json (content_hash: abc123)
ë²„ì „ 2: annotations.json (content_hash: def456)

ì¥ì :
- content_hash 1ê°œë¡œ ì „ì²´ ë³€ê²½ ì¶”ì 
- Git diff ëª…í™•
- ë¡¤ë°± ê°„ë‹¨
```

---

#### E. ë™ì‹œ í¸ì§‘ (í˜‘ì—…)

**ë¶„ì‚°í˜• (v0.9)**
```
ì‚¬ìš©ì A: labels/img001.json ìˆ˜ì •
ì‚¬ìš©ì B: labels/img002.json ìˆ˜ì •

â†’ ì¶©ëŒ ì—†ìŒ âœ… (íŒŒì¼ë³„ ë…ë¦½)
```

**í†µí•©í˜• (v1.0)**
```
ì‚¬ìš©ì A: annotations.json[images[0]] ìˆ˜ì •
ì‚¬ìš©ì B: annotations.json[images[1]] ìˆ˜ì •

â†’ Git ì¶©ëŒ ë°œìƒ âš ï¸
```

**í•´ê²° ë°©ì•ˆ:**
- Lock mechanism (Backend API)
- Optimistic locking (version í•„ë“œ)
- ì¶©ëŒ ìë™ ë³‘í•© (non-overlapping edits)

```python
# Backend APIì—ì„œ ë‚™ê´€ì  ë½ êµ¬í˜„
@router.put("/datasets/{id}/images/{image_id}/annotation")
async def update_annotation(
    id: str,
    image_id: int,
    annotation: dict,
    current_version: int  # â† í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚¸ ë²„ì „
):
    dataset = db.get_dataset(id)

    if dataset.version != current_version:
        raise HTTPException(
            status_code=409,
            detail="Dataset was modified by another user"
        )

    # ì—…ë°ì´íŠ¸ ìˆ˜í–‰
    dataset.images[image_id].annotation = annotation
    dataset.version += 1
    dataset.content_hash = calc_hash(dataset)

    db.save(dataset)
```

---

### ì¥ë‹¨ì  ìš”ì•½

#### ë¶„ì‚°í˜• (v0.9) ì¥ë‹¨ì 

**ì¥ì :**
- âœ… íŒŒì¼ë³„ ë…ë¦½ (ë™ì‹œ í¸ì§‘ ì¶©ëŒ ì ìŒ)
- âœ… ë¶€ë¶„ ìˆ˜ì • ê°„í¸ (1ê°œ íŒŒì¼ë§Œ ìˆ˜ì •)
- âœ… ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì— ì í•©

**ë‹¨ì :**
- âŒ íŒŒì¼ ìˆ˜ ë§ìŒ (1000ê°œ+)
- âŒ ë¡œë”© ëŠë¦¼ (1000ë²ˆ I/O)
- âŒ Cloud ì—…ë¡œë“œ ëŠë¦¼ (1000ë²ˆ PUT)
- âŒ ìŠ¤í† ë¦¬ì§€ ë¹„íš¨ìœ¨ (ì¤‘ë³µ ë©”íƒ€ë°ì´í„°)
- âŒ ê²€ìƒ‰/ì¸ë±ì‹± ì–´ë ¤ì›€
- âŒ ë²„ì „ ê´€ë¦¬ ë³µì¡

#### í†µí•©í˜• (v1.0) ì¥ë‹¨ì 

**ì¥ì :**
- âœ… íŒŒì¼ 1ê°œ (ê°„ë‹¨)
- âœ… ë¡œë”© ë¹ ë¦„ (1ë²ˆ I/O)
- âœ… Cloud ìµœì í™” (1ë²ˆ PUT/GET)
- âœ… ìŠ¤í† ë¦¬ì§€ íš¨ìœ¨ (47% ì ˆì•½)
- âœ… ê²€ìƒ‰/ì¸ë±ì‹± ì‰¬ì›€
- âœ… ë²„ì „ ê´€ë¦¬ ê°„ë‹¨ (content_hash 1ê°œ)
- âœ… í†µê³„ ìë™ ê³„ì‚°

**ë‹¨ì :**
- âŒ ë™ì‹œ í¸ì§‘ ì¶©ëŒ ê°€ëŠ¥
- âŒ ì „ì²´ íŒŒì¼ ë‹¤ìš´ë¡œë“œ í•„ìš”

---

## ìŸì  2: ìƒëŒ€ ê²½ë¡œ vs ì ˆëŒ€ ê²½ë¡œ

### ğŸ“Š ë¹„êµí‘œ

| í•­ëª© | ì ˆëŒ€ ê²½ë¡œ (v0.9) | ìƒëŒ€ ê²½ë¡œ (v1.0) |
|------|------------------|------------------|
| **ê²½ë¡œ ì˜ˆì‹œ** | `E:/datasets/images/img001.jpg` | `images/img001.jpg` |
| **ì´ì‹ì„±** | âŒ ì—†ìŒ (E:/ ê³ ì •) | âœ… ìˆìŒ (ì–´ë””ë“  ê°€ëŠ¥) |
| **Cloud í˜¸í™˜** | âŒ ë¶ˆê°€ëŠ¥ (ë¡œì»¬ ê²½ë¡œ) | âœ… ê°€ëŠ¥ (S3, R2, GCS) |
| **ê³µìœ ** | âŒ ì–´ë ¤ì›€ (ê²½ë¡œ ë‹¤ë¦„) | âœ… ì‰¬ì›€ (ìƒëŒ€ ê²½ë¡œ) |
| **OS í˜¸í™˜** | âŒ Windows only | âœ… Cross-platform |
| **URL ë³€í™˜** | ë¶ˆê°€ëŠ¥ | `s3://bucket/datasets/user123/images/img001.jpg` |

---

### ìƒì„¸ ë¶„ì„

#### A. ì´ì‹ì„± (Portability)

**ì ˆëŒ€ ê²½ë¡œ (v0.9)**
```json
{
  "data_summary": [
    {
      "img_path": "E:/datasets/cats-dogs/images/cat001.jpg",
      "label_path": "E:/datasets/cats-dogs/labels/cat001.json"
    }
  ]
}

ë¬¸ì œ:
- ì‚¬ìš©ì A: E:/ ë“œë¼ì´ë¸Œ ì‚¬ìš©
- ì‚¬ìš©ì B: C:/ ë“œë¼ì´ë¸Œ ì‚¬ìš©
- ì‚¬ìš©ì C: /home/user/datasets/ (Linux)

â†’ ê°ì ê²½ë¡œ ìˆ˜ì • í•„ìš” âŒ
```

**ìƒëŒ€ ê²½ë¡œ (v1.0)**
```json
{
  "images": [
    {
      "file_name": "images/cat001.jpg"  // â† ìƒëŒ€ ê²½ë¡œ
    }
  ]
}

Base Path:
- ë¡œì»¬: /workspace/datasets/user123-cats-dogs/
- R2: s3://bucket/datasets/user123-cats-dogs/

ì‹¤ì œ ê²½ë¡œ:
- ë¡œì»¬: /workspace/datasets/user123-cats-dogs/images/cat001.jpg
- R2: s3://bucket/datasets/user123-cats-dogs/images/cat001.jpg

â†’ ì–´ë””ì„œë“  ì‘ë™ âœ…
```

---

#### B. Cloud Storage í˜¸í™˜ì„±

**ì ˆëŒ€ ê²½ë¡œ (v0.9)**
```python
# R2 ì—…ë¡œë“œ ì‹œ
img_path = "E:/datasets/images/cat001.jpg"

# ë¬¸ì œ: R2ì— ì–´ë–»ê²Œ ì €ì¥?
# Option 1: ê²½ë¡œ ê·¸ëŒ€ë¡œ â†’ ì˜ë¯¸ ì—†ìŒ
r2.upload("E:/datasets/images/cat001.jpg", local_file)

# Option 2: ê²½ë¡œ ì¬ì‘ì„± â†’ annotations ìˆ˜ì • í•„ìš”
new_path = "images/cat001.jpg"
annotation['img_path'] = new_path  # â† ì›ë³¸ íŒŒê´´

â†’ R2 ì—…ë¡œë“œ ì‹œ annotation íŒŒì¼ ìˆ˜ì • í•„ìš” âŒ
```

**ìƒëŒ€ ê²½ë¡œ (v1.0)**
```python
# R2 ì—…ë¡œë“œ ì‹œ
file_name = "images/cat001.jpg"  # â† ì´ë¯¸ ìƒëŒ€ ê²½ë¡œ

# R2 ì €ì¥
r2.upload(
    key=f"datasets/user123/{file_name}",
    local_file=local_file
)

# ë‹¤ìš´ë¡œë“œ
r2.download(
    key=f"datasets/user123/{file_name}",
    local_file=f"/workspace/datasets/user123/{file_name}"
)

â†’ annotations.json ìˆ˜ì • ë¶ˆí•„ìš” âœ…
```

---

#### C. ê³µìœ  ë° ë°°í¬

**ì‹œë‚˜ë¦¬ì˜¤: ë°ì´í„°ì…‹ ê³µìœ **

**ì ˆëŒ€ ê²½ë¡œ (v0.9)**
```
ì‚¬ìš©ì A (Windows):
  E:/my-datasets/cats-dogs/
  â”œâ”€â”€ images/
  â”œâ”€â”€ labels/
  â””â”€â”€ label_map.json
      â†’ img_path: "E:/my-datasets/cats-dogs/images/cat001.jpg"

ZIPìœ¼ë¡œ ì••ì¶• â†’ ì‚¬ìš©ì Bì—ê²Œ ì „ë‹¬

ì‚¬ìš©ì B (Mac):
  /Users/bob/Downloads/cats-dogs/
  â”œâ”€â”€ images/
  â”œâ”€â”€ labels/
  â””â”€â”€ label_map.json
      â†’ img_path: "E:/my-datasets/cats-dogs/images/cat001.jpg"
      âŒ ê²½ë¡œ ê¹¨ì§!

í•´ê²°: ìˆ˜ë™ìœ¼ë¡œ ëª¨ë“  ê²½ë¡œ ìˆ˜ì • í•„ìš” (1000ê°œ íŒŒì¼!)
```

**ìƒëŒ€ ê²½ë¡œ (v1.0)**
```
ì‚¬ìš©ì A:
  /any/path/cats-dogs/
  â”œâ”€â”€ images/
  â”œâ”€â”€ annotations.json
      â†’ file_name: "images/cat001.jpg"

ZIPìœ¼ë¡œ ì••ì¶• â†’ ì‚¬ìš©ì Bì—ê²Œ ì „ë‹¬

ì‚¬ìš©ì B:
  /different/path/cats-dogs/
  â”œâ”€â”€ images/
  â”œâ”€â”€ annotations.json
      â†’ file_name: "images/cat001.jpg"
      âœ… ê·¸ëŒ€ë¡œ ì‘ë™!

í•´ê²°: ì••ì¶• í•´ì œë§Œ í•˜ë©´ ë
```

---

#### D. URL ìŠ¤í‚´ ì§€ì›

**ì ˆëŒ€ ê²½ë¡œ (v0.9)**
```json
{
  "img_path": "E:/datasets/images/cat001.jpg"
}

ì§€ì›:
- âœ… ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œë§Œ
- âŒ HTTP URL ë¶ˆê°€
- âŒ S3 URL ë¶ˆê°€
- âŒ GCS URL ë¶ˆê°€
```

**ìƒëŒ€ ê²½ë¡œ (v1.0)**
```json
{
  "file_name": "images/cat001.jpg"
}

Base URLì— ë”°ë¼ ìë™ í•´ì„:
- ë¡œì»¬: /workspace/datasets/user123/images/cat001.jpg
- R2: s3://bucket/datasets/user123/images/cat001.jpg
- HTTP: https://cdn.example.com/datasets/user123/images/cat001.jpg
- GCS: gs://bucket/datasets/user123/images/cat001.jpg

â†’ ì–´ë–¤ ìŠ¤í† ë¦¬ì§€ë“  ì§€ì› âœ…
```

---

#### E. ë§ˆì´ê·¸ë ˆì´ì…˜ ë³µì¡ë„

**ì ˆëŒ€ ê²½ë¡œ ìœ ì§€ ì‹œ**
```python
# v0.9 â†’ v1.0 ë³€í™˜
original_path = "E:/datasets/cats-dogs/images/cat001.jpg"

# ë¬¸ì œ: ì ˆëŒ€ ê²½ë¡œë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬?
# Option 1: ê·¸ëŒ€ë¡œ ìœ ì§€ â†’ R2 ì—…ë¡œë“œ ë¶ˆê°€
# Option 2: ìƒëŒ€ ê²½ë¡œë¡œ ë³€í™˜ â†’ ë¡œì»¬ ì‚¬ìš©ì ê¹¨ì§
# Option 3: ì–‘ìª½ ë‹¤ ì €ì¥ â†’ ë³µì¡

â†’ ì–´ë–¤ ì„ íƒë„ ì™„ë²½í•˜ì§€ ì•ŠìŒ
```

**ìƒëŒ€ ê²½ë¡œ ì „í™˜ ì‹œ**
```python
# v0.9 â†’ v1.0 ë³€í™˜
original_path = "E:/datasets/cats-dogs/images/cat001.jpg"

# ìƒëŒ€ ê²½ë¡œ ì¶”ì¶œ
base_path = "E:/datasets/cats-dogs/"
relative_path = os.path.relpath(original_path, base_path)
# â†’ "images/cat001.jpg"

# v1.0ì— ì €ì¥
{
  "file_name": "images/cat001.jpg",
  "legacy_v09": {
    "original_path": "E:/datasets/cats-dogs/images/cat001.jpg"
  }
}

â†’ ê¹”ë”í•œ ë³€í™˜ + ì›ë³¸ ê²½ë¡œ ë³´ì¡´ âœ…
```

---

### ì¥ë‹¨ì  ìš”ì•½

#### ì ˆëŒ€ ê²½ë¡œ (v0.9) ì¥ë‹¨ì 

**ì¥ì :**
- âœ… ì§ê´€ì  (ì‹¤ì œ íŒŒì¼ ìœ„ì¹˜)
- âœ… ë¡œì»¬ì—ì„œ ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥

**ë‹¨ì :**
- âŒ ì´ì‹ì„± ì—†ìŒ (ë“œë¼ì´ë¸Œ/OS ê³ ì •)
- âŒ Cloud ì—…ë¡œë“œ ì‹œ ê²½ë¡œ ì¬ì‘ì„± í•„ìš”
- âŒ ê³µìœ  ì‹œ ê²½ë¡œ ê¹¨ì§
- âŒ URL ìŠ¤í‚´ ì§€ì› ë¶ˆê°€
- âŒ Cross-platform ë¶ˆê°€

#### ìƒëŒ€ ê²½ë¡œ (v1.0) ì¥ë‹¨ì 

**ì¥ì :**
- âœ… ì´ì‹ì„± (ì–´ë””ì„œë“  ì‘ë™)
- âœ… Cloud í˜¸í™˜ (S3, R2, GCS)
- âœ… ê³µìœ  ì‰¬ì›€ (ZIP ì••ì¶• í›„ ë°°í¬)
- âœ… URL ìŠ¤í‚´ ì§€ì› (HTTP, S3, GCS)
- âœ… Cross-platform (Windows, Mac, Linux)

**ë‹¨ì :**
- âŒ Base path ë³„ë„ ê´€ë¦¬ í•„ìš”

---

## ì¢…í•© ë¹„êµ

### ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¹„êµ

| ì‹œë‚˜ë¦¬ì˜¤ | ë¶„ì‚°í˜• + ì ˆëŒ€ ê²½ë¡œ (v0.9) | í†µí•©í˜• + ìƒëŒ€ ê²½ë¡œ (v1.0) |
|----------|----------------------------|----------------------------|
| **ë¡œì»¬ ë‹¨ë… ì‚¬ìš©** | â­â­â­â­â­ ì™„ë²½ | â­â­â­â­ ì¢‹ìŒ |
| **Cloud ì—…ë¡œë“œ** | â­ ë§¤ìš° ë‚˜ì¨ | â­â­â­â­â­ ì™„ë²½ |
| **ë°ì´í„°ì…‹ ê³µìœ ** | â­ ë§¤ìš° ë‚˜ì¨ | â­â­â­â­â­ ì™„ë²½ |
| **í˜‘ì—… (ë‹¤ì¤‘ ì‚¬ìš©ì)** | â­â­â­ ë³´í†µ | â­â­â­â­ ì¢‹ìŒ |
| **ëŒ€ìš©ëŸ‰ (10K+ images)** | â­â­ ë‚˜ì¨ | â­â­â­â­â­ ì™„ë²½ |
| **ê²€ìƒ‰/í•„í„°ë§** | â­â­ ë‚˜ì¨ | â­â­â­â­â­ ì™„ë²½ |
| **ë²„ì „ ê´€ë¦¬** | â­â­ ë‚˜ì¨ | â­â­â­â­â­ ì™„ë²½ |
| **ë™ì‹œ í¸ì§‘** | â­â­â­â­ ì¢‹ìŒ | â­â­â­ ë³´í†µ |

---

### ì„±ëŠ¥ ë¹„êµ (1000 images ê¸°ì¤€)

| ì‘ì—… | v0.9 | v1.0 | ê°œì„  |
|------|------|------|------|
| **íŒŒì¼ ë¡œë”©** | 2-3ì´ˆ | 0.1-0.2ì´ˆ | **10-30ë°°** |
| **Cloud ì—…ë¡œë“œ** | 30-60ì´ˆ | 1-2ì´ˆ | **30ë°°** |
| **Cloud ë‹¤ìš´ë¡œë“œ** | 30-60ì´ˆ | 1-2ì´ˆ | **30ë°°** |
| **ê²€ìƒ‰ (í´ë˜ìŠ¤ë³„)** | 2-3ì´ˆ | 0.01ì´ˆ | **200ë°°** |
| **í†µê³„ ê³„ì‚°** | 5-10ì´ˆ | ì¦‰ì‹œ (pre-computed) | **âˆë°°** |
| **ìŠ¤í† ë¦¬ì§€** | 1.5MB | 0.8MB | **47% ì ˆì•½** |
| **API í˜¸ì¶œ** | 1000íšŒ | 1íšŒ | **99.9% ì ˆê°** |

---

## ìµœì¢… ê²°ì • ë° ê·¼ê±°

### âœ… ìµœì¢… ê²°ì •

| í•­ëª© | ê²°ì • | ê·¼ê±° |
|------|------|------|
| **Annotation êµ¬ì¡°** | **í†µí•©í˜•** (annotations.json) | Cloud ìµœì í™”, ì„±ëŠ¥, ê´€ë¦¬ í¸ì˜ì„± |
| **ê²½ë¡œ ë°©ì‹** | **ìƒëŒ€ ê²½ë¡œ** | ì´ì‹ì„±, Cloud í˜¸í™˜ì„±, ê³µìœ  ìš©ì´ |

---

### ê²°ì • ê·¼ê±°

#### 1. Cloud-First í”Œë«í¼

**í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” Cloud ê¸°ë°˜ í”Œë«í¼**
- R2 (Cloudflare Object Storage) ì¤‘ì‹¬ ì•„í‚¤í…ì²˜
- ë¡œì»¬ ê°œë°œ í™˜ê²½ë„ ê²°êµ­ R2ë¡œ ì—…ë¡œë“œ
- ì‚¬ìš©ì ê°„ ë°ì´í„° ê³µìœ  (Public datasets)

â†’ **Cloud ìµœì í™”ê°€ ìµœìš°ì„ **

**í†µí•©í˜• + ìƒëŒ€ ê²½ë¡œ = Cloudì— ìµœì **
- 1ë²ˆì˜ PUT/GETìœ¼ë¡œ ì „ì²´ ë°ì´í„°ì…‹ ì²˜ë¦¬
- URL ìŠ¤í‚´ ìë™ ì§€ì› (s3://, https://)
- CDN ë°°í¬ ê°€ëŠ¥

---

#### 2. ì„±ëŠ¥

**ì‹¤ì œ ì‚¬ìš© íŒ¨í„´:**
```
ë¡œë”© ë¹ˆë„:
- í•™ìŠµ ì‹œì‘: 1íšŒ (ì „ì²´ ë¡œë”©)
- ê²€ì¦: 1íšŒ (ì „ì²´ ë¡œë”©)
- ì¶”ë¡ : 1íšŒ (ì „ì²´ ë¡œë”©)

ìˆ˜ì • ë¹ˆë„:
- ê°œë³„ ìˆ˜ì •: ë“œë¬¼ìŒ
- ë°°ì¹˜ ìˆ˜ì •: ìì£¼ (ë ˆì´ë¸”ë§ ì„¸ì…˜)
```

**ë¶„ì‚°í˜•ì˜ ì´ì  (ê°œë³„ ìˆ˜ì •)ì´ ì‹¤ì œë¡œëŠ” ê±°ì˜ ì—†ìŒ:**
- ë ˆì´ë¸”ë§ íˆ´ì—ì„œ ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì‘ì—…
- ê²°ê³¼ë¥¼ ë°°ì¹˜ë¡œ ì €ì¥
- ê°œë³„ íŒŒì¼ ìˆ˜ì •ì€ ê±°ì˜ ë°œìƒí•˜ì§€ ì•ŠìŒ

**í†µí•©í˜•ì´ ì‹¤ì§ˆì ìœ¼ë¡œ í›¨ì”¬ ë¹ ë¦„:**
- í•™ìŠµ ì‹œì‘: 10-30ë°° ë¹ ë¦„
- Cloud ë™ê¸°í™”: 30ë°° ë¹ ë¦„

---

#### 3. í™•ì¥ì„±

**ë°ì´í„°ì…‹ ê·œëª¨ ì¦ê°€ ì‹œ:**

```
100 images:
  v0.9: 101 files, ë¡œë”© 200ms
  v1.0: 1 file, ë¡œë”© 10ms

1,000 images:
  v0.9: 1,001 files, ë¡œë”© 2-3s
  v1.0: 1 file, ë¡œë”© 100-200ms

10,000 images:
  v0.9: 10,001 files, ë¡œë”© 20-30s âŒ
  v1.0: 1 file, ë¡œë”© 1-2s âœ…

100,000 images:
  v0.9: 100,001 files, ë¡œë”© 3-5ë¶„ âŒâŒ
  v1.0: 1 file, ë¡œë”© 10-20s âœ…
```

**ImageNet (1.4M images) ê°™ì€ ëŒ€í˜• ë°ì´í„°ì…‹ ì§€ì› ë¶ˆê°€:**
- v0.9: 1,400,001ê°œ íŒŒì¼ â†’ ë¶ˆê°€ëŠ¥
- v1.0: 1ê°œ íŒŒì¼ (100-200MB) â†’ ê°€ëŠ¥

---

#### 4. ë¹„ìš©

**R2 ë¹„ìš© (1000ëª… ì‚¬ìš©ì, ê° 10íšŒ ì—…ë°ì´íŠ¸):**
- v0.9: $48.6
- v1.0: $0.081

**ì ˆì•½: $48.52 (99.8%)**

---

## í•˜ìœ„ í˜¸í™˜ì„± í•´ê²° ë°©ì•ˆ

### ê¸°ì¡´ ì‚¬ìš©ì ë³´í˜¸ ì „ëµ

#### 1. Auto-Migration (ìë™ ë³€í™˜)

```python
# v0.9 ì—…ë¡œë“œ ê°ì§€
if detect_format(files) == "v0.9":
    # ìë™ ë³€í™˜
    annotations_v10 = migrate_v09_to_v10(files)

    # ì›ë³¸ ì ˆëŒ€ ê²½ë¡œ ë³´ì¡´
    annotations_v10['migration_info'] = {
        'migrated_from': 'v0.9',
        'original_paths': {
            'images': 'E:/my-datasets/images/',
            'labels': 'E:/my-datasets/labels/'
        }
    }

    # ê° ì´ë¯¸ì§€ì— legacy ì •ë³´ ë³´ì¡´
    for img in annotations_v10['images']:
        img['legacy_v09'] = {
            'original_img_path': 'E:/my-datasets/images/img001.jpg',
            'original_label_path': 'E:/my-datasets/labels/img001.json',
            'shapes': [...]  # ì›ë³¸ shapes ë³´ì¡´
        }
```

**ì‚¬ìš©ì ê²½í—˜:**
```
1. ì‚¬ìš©ì: v0.9 ZIP ì—…ë¡œë“œ
2. í”Œë«í¼: "v0.9 í¬ë§·ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. v1.0ìœ¼ë¡œ ìë™ ë³€í™˜ë©ë‹ˆë‹¤."
3. ì‚¬ìš©ì: "í™•ì¸" í´ë¦­
4. í”Œë«í¼: 3-5ì´ˆ í›„ "âœ… ë³€í™˜ ì™„ë£Œ!"
5. ì‚¬ìš©ì: ë°”ë¡œ í•™ìŠµ ê°€ëŠ¥
```

---

#### 2. Legacy Backup (ì›ë³¸ ë³´ì¡´)

**R2 êµ¬ì¡°:**
```
s3://bucket/datasets/user123-my-dataset/
â”œâ”€â”€ annotations.json              â† v1.0 (ìƒëŒ€ ê²½ë¡œ)
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ img001.jpg
â”‚   â””â”€â”€ img002.jpg
â”œâ”€â”€ legacy/                       â† v0.9 ë°±ì—…
â”‚   â”œâ”€â”€ labels/
â”‚   â”‚   â”œâ”€â”€ img001.json          â† ì›ë³¸ (ì ˆëŒ€ ê²½ë¡œ)
â”‚   â”‚   â””â”€â”€ img002.json
â”‚   â””â”€â”€ label_map.json
â””â”€â”€ meta.json
```

**ë‹¤ìš´ë¡œë“œ ì˜µì…˜:**
```
1. v1.0 ë‹¤ìš´ë¡œë“œ (ê¸°ë³¸)
   â†’ annotations.json + images/

2. v0.9 ë‹¤ìš´ë¡œë“œ (ë ˆê±°ì‹œ)
   â†’ legacy/labels/ + legacy/label_map.json + images/
   â†’ ì ˆëŒ€ ê²½ë¡œ ë³µì› ê°€ëŠ¥
```

---

#### 3. ì–‘ë°©í–¥ Export (v1.0 â†” v0.9)

```python
# v1.0 â†’ v0.9 export
class V10ToV09Exporter:
    def export(self, annotations_v10: dict, target_base_path: str) -> dict:
        """
        v1.0 â†’ v0.9 ë³€í™˜.

        Args:
            target_base_path: ë³µì›í•  ì ˆëŒ€ ê²½ë¡œ (ì˜ˆ: "E:/my-datasets/")
        """
        label_map = {
            "task_type": self._convert_task_type(annotations_v10['task_type']),
            "class_summary": {...},
            "data_summary": []
        }

        labels = {}

        for img in annotations_v10['images']:
            # ì ˆëŒ€ ê²½ë¡œ ìƒì„±
            img_path = os.path.join(target_base_path, "images", img['file_name'])
            label_path = os.path.join(target_base_path, "labels",
                                     f"{img['id']:03d}.json")

            label_map['data_summary'].append({
                "img_path": img_path,
                "label_path": label_path
            })

            # ê°œë³„ ë ˆì´ë¸” íŒŒì¼ ìƒì„±
            labels[f"{img['id']:03d}.json"] = {
                "version": "0.9",
                "task_type": self._convert_task_type(annotations_v10['task_type']),
                "shapes": self._convert_annotation(img['annotation']),
                "split": img['split'],
                "imageHeight": img['height'],
                "imageWidth": img['width'],
                "imageDepth": img.get('depth', 3)
            }

        return {
            "label_map.json": label_map,
            "labels/": labels
        }
```

**ì‚¬ìš©ì ê²½í—˜:**
```
í”Œë«í¼ UI:
  [ë‹¤ìš´ë¡œë“œ â–¼]
    â”œâ”€ v1.0 ë‹¤ìš´ë¡œë“œ (ê¶Œì¥)
    â””â”€ v0.9 ë‹¤ìš´ë¡œë“œ (ë ˆê±°ì‹œ íˆ´ í˜¸í™˜)
       â†’ ë³µì›í•  ê²½ë¡œ ì…ë ¥: [E:/my-datasets/] [í™•ì¸]
       â†’ ZIP ë‹¤ìš´ë¡œë“œ (ì ˆëŒ€ ê²½ë¡œ ë³µì›ë¨)
```

---

#### 4. ë™ì‹œ ì‚¬ìš© ì§€ì› (Hybrid Workflow)

**ì‹œë‚˜ë¦¬ì˜¤: ë¡œì»¬ íˆ´ + í”Œë«í¼ ë³‘í–‰ ì‚¬ìš©**

```
Day 1: ë¡œì»¬ íˆ´ë¡œ 100ì¥ ë ˆì´ë¸”ë§ (v0.9)
  â†’ E:/my-datasets/labels/

Day 2: í”Œë«í¼ ì—…ë¡œë“œ
  â†’ ìë™ ë³€í™˜ â†’ v1.0
  â†’ R2ì— ì €ì¥

Day 3: í”Œë«í¼ì—ì„œ 50ì¥ ì¶”ê°€ ë ˆì´ë¸”ë§ (v1.0)
  â†’ R2 ì—…ë°ì´íŠ¸

Day 4: ë‹¤ì‹œ ë¡œì»¬ì—ì„œ ì‘ì—…í•˜ê³  ì‹¶ìŒ
  â†’ v0.9 export ë‹¤ìš´ë¡œë“œ
  â†’ E:/my-datasets/labels/ ë³µì›
  â†’ ë¡œì»¬ íˆ´ë¡œ ê³„ì† ì‘ì—…

Day 5: ìµœì¢…ë³¸ ë‹¤ì‹œ í”Œë«í¼ ì—…ë¡œë“œ
  â†’ ìë™ ë³‘í•© (conflict resolution)
```

---

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ê¸°ì¡´ ì‚¬ìš©ì ë³´í˜¸

- [x] **ì •ë³´ ì†ì‹¤ ì—†ìŒ**: legacy_v09 í•„ë“œë¡œ ì›ë³¸ 100% ë³´ì¡´
- [x] **ì›ë³¸ ë³µì› ê°€ëŠ¥**: v0.9 export ì§€ì›
- [x] **íˆ¬ëª…í•œ ë³€í™˜**: ìë™ ê°ì§€ + ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€
- [x] **ì ì§„ì  ì „í™˜**: ë¡œì»¬ íˆ´ ê³„ì† ì‚¬ìš© ê°€ëŠ¥ (ì–‘ë°©í–¥ sync)
- [x] **ë¡¤ë°± ê°€ëŠ¥**: legacy/ í´ë”ì— ì›ë³¸ ë°±ì—…

#### ì‹ ê·œ ì‚¬ìš©ì ê²½í—˜

- [x] **í˜„ëŒ€ì  í¬ë§·**: annotations.json (COCO í˜¸í™˜)
- [x] **Cloud ìµœì í™”**: ìƒëŒ€ ê²½ë¡œ, ë‹¨ì¼ íŒŒì¼
- [x] **ë¹ ë¥¸ ì„±ëŠ¥**: 10-30ë°° ë¹ ë¥¸ ë¡œë”©
- [x] **í™•ì¥ ê°€ëŠ¥**: 100K+ images ì§€ì›

---

## ê²°ë¡ 

### ìµœì¢… ê²°ì •

**v1.0 Platform Format:**
- âœ… **í†µí•©í˜• Annotation** (annotations.json)
- âœ… **ìƒëŒ€ ê²½ë¡œ**
- âœ… **100% í•˜ìœ„ í˜¸í™˜** (auto-migration + legacy backup)

### í•µì‹¬ ê·¼ê±°

1. **Cloud-First í”Œë«í¼**: R2 ì¤‘ì‹¬ ì•„í‚¤í…ì²˜ì— ìµœì 
2. **ì„±ëŠ¥**: 10-30ë°° ë¹ ë¥¸ ë¡œë”©, 99.9% API í˜¸ì¶œ ì ˆê°
3. **í™•ì¥ì„±**: ImageNet ê¸‰ ëŒ€í˜• ë°ì´í„°ì…‹ ì§€ì›
4. **ë¹„ìš©**: 99.8% ì ˆì•½
5. **í•˜ìœ„ í˜¸í™˜**: ê¸°ì¡´ ì‚¬ìš©ì 100% ë³´í˜¸ (auto-migration + export)

### ê¸°ì¡´ ì‚¬ìš©ìì—ê²Œ

**ê±±ì • ë§ˆì„¸ìš”!**
- âœ… ì›ë³¸ ì •ë³´ 100% ë³´ì¡´ë¨
- âœ… v0.9ë¡œ ë‹¤ì‹œ export ê°€ëŠ¥
- âœ… ë¡œì»¬ íˆ´ ê³„ì† ì‚¬ìš© ê°€ëŠ¥
- âœ… íˆ¬ëª…í•œ ìë™ ë³€í™˜ (3-5ì´ˆ)

**í˜œíƒ:**
- âœ… Cloudì—ì„œ ì–´ë””ì„œë“  ì ‘ê·¼
- âœ… íŒ€ì›ê³¼ ì‰½ê²Œ ê³µìœ 
- âœ… ë²„ì „ ê´€ë¦¬ ìë™í™”
- âœ… ë¹ ë¥¸ í•™ìŠµ ì‹œì‘

---

**Last Updated:** 2025-01-04
**Decision Status:** âœ… Approved
**Implementation:** Ready to Start
