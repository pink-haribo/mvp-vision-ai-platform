# NodePort Services for External Access
# Apply after Helm deployments to enable localhost access
#
# Usage:
#   kubectl apply -f nodeports.yaml

---
# PostgreSQL NodePort
apiVersion: v1
kind: Service
metadata:
  name: postgresql-nodeport
  namespace: platform
  labels:
    app.kubernetes.io/name: postgresql
    app.kubernetes.io/instance: postgresql
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: postgresql
    app.kubernetes.io/instance: postgresql
  ports:
  - port: 5432
    targetPort: 5432
    nodePort: 30543
    protocol: TCP
    name: postgresql

---
# Redis NodePort
apiVersion: v1
kind: Service
metadata:
  name: redis-nodeport
  namespace: platform
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/instance: redis
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: redis
    app.kubernetes.io/instance: redis
    app.kubernetes.io/component: master
  ports:
  - port: 6379
    targetPort: 6379
    nodePort: 30679
    protocol: TCP
    name: redis

---
# MinIO API NodePort
apiVersion: v1
kind: Service
metadata:
  name: minio-api-nodeport
  namespace: platform
  labels:
    app.kubernetes.io/name: minio
    app.kubernetes.io/instance: minio
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: minio
    app.kubernetes.io/instance: minio
  ports:
  - port: 9000
    targetPort: 9000
    nodePort: 30900
    protocol: TCP
    name: api

---
# MinIO Console NodePort
apiVersion: v1
kind: Service
metadata:
  name: minio-console-nodeport
  namespace: platform
  labels:
    app.kubernetes.io/name: minio
    app.kubernetes.io/instance: minio
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: minio
    app.kubernetes.io/instance: minio
  ports:
  - port: 9001
    targetPort: 9001
    nodePort: 30901
    protocol: TCP
    name: console
