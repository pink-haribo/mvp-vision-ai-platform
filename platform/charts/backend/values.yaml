# Vision AI Backend - Helm Values
# Configure these values for your internal K8s environment

# ===========================================
# Image Configuration
# ===========================================
image:
  repository: vision-ai-backend
  tag: "latest"
  pullPolicy: IfNotPresent

imagePullSecrets: []
# - name: my-registry-secret

# ===========================================
# Replica & Resource Configuration
# ===========================================
replicaCount: 1

resources:
  limits:
    cpu: "2"
    memory: "4Gi"
  requests:
    cpu: "500m"
    memory: "1Gi"

# ===========================================
# Service Configuration
# ===========================================
service:
  type: ClusterIP
  port: 8000
  # For NodePort access (optional)
  # type: NodePort
  # nodePort: 30800

# ===========================================
# Ingress Configuration (Optional)
# ===========================================
ingress:
  enabled: false
  className: "nginx"
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: api.vision-ai.local
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: api-tls
  #    hosts:
  #      - api.vision-ai.local

# ===========================================
# External Services Configuration
# ===========================================
# Configure these to point to your existing services

# PostgreSQL (Platform Database)
postgresql:
  host: "postgresql.database.svc.cluster.local"
  port: 5432
  database: "platform"
  username: "admin"
  # Password should be provided via secret
  existingSecret: ""
  existingSecretPasswordKey: "password"
  # Or set directly (not recommended for production)
  password: ""

# PostgreSQL (Shared User Database)
userPostgresql:
  host: "postgresql.database.svc.cluster.local"
  port: 5432
  database: "users"
  username: "admin"
  existingSecret: ""
  existingSecretPasswordKey: "password"
  password: ""

# Redis
redis:
  host: "redis.database.svc.cluster.local"
  port: 6379
  database: 0
  # password: ""
  existingSecret: ""
  existingSecretPasswordKey: "password"

# MinIO / S3 Storage
storage:
  # Internal storage (checkpoints, models)
  internal:
    endpoint: "http://minio.storage.svc.cluster.local:9000"
    accessKey: ""
    secretKey: ""
    existingSecret: ""
    buckets:
      weights: "model-weights"
      checkpoints: "training-checkpoints"
      schemas: "config-schemas"
      results: "training-results"
  # External storage (datasets)
  external:
    endpoint: "http://minio.storage.svc.cluster.local:9000"
    accessKey: ""
    secretKey: ""
    existingSecret: ""
    buckets:
      datasets: "training-datasets"

# ===========================================
# LLM Configuration
# ===========================================
llm:
  # Provider: "openai" or "gemini"
  provider: "openai"
  model: "gpt-4o-mini"
  temperature: "0.0"

  # OpenAI settings (when provider=openai)
  openai:
    apiKey: ""
    baseUrl: "https://api.openai.com/v1"
    existingSecret: ""
    existingSecretKey: "api-key"

  # Gemini settings (when provider=gemini)
  gemini:
    apiKey: ""
    existingSecret: ""
    existingSecretKey: "api-key"

# ===========================================
# Security Configuration
# ===========================================
security:
  jwtSecret: ""
  jwtAlgorithm: "HS256"
  accessTokenExpireMinutes: 60
  refreshTokenExpireDays: 7
  serviceJwtSecret: ""
  existingSecret: ""

# ===========================================
# Observability Configuration
# ===========================================
observability:
  # Comma-separated: database, clearml, mlflow, wandb
  backends: "database"

  clearml:
    enabled: false
    apiHost: ""
    webHost: ""
    filesHost: ""
    accessKey: ""
    secretKey: ""

  mlflow:
    enabled: false
    trackingUri: ""

# ===========================================
# Application Configuration
# ===========================================
config:
  # CORS origins (comma-separated)
  corsOrigins: "http://localhost:3000"
  # Log level: DEBUG, INFO, WARNING, ERROR
  logLevel: "INFO"
  # Training mode: subprocess, kubernetes
  trainingMode: "kubernetes"
  # API Base URL (for callbacks)
  apiBaseUrl: "http://vision-ai-backend:8000"

# ===========================================
# Temporal Configuration (Optional)
# ===========================================
temporal:
  enabled: false
  host: "temporal.temporal.svc.cluster.local:7233"
  namespace: "default"
  taskQueue: "training-tasks"

# ===========================================
# Labeler Service Integration (Optional)
# ===========================================
labeler:
  enabled: false
  apiUrl: "http://labeler-backend:8011"
  serviceKey: ""
  existingSecret: ""

# ===========================================
# Pod Configuration
# ===========================================
podAnnotations: {}
podSecurityContext: {}
securityContext: {}

nodeSelector: {}
tolerations: []
affinity: {}

# Health checks
livenessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

# ===========================================
# Persistence (Optional)
# ===========================================
persistence:
  enabled: false
  storageClass: ""
  size: "10Gi"
  accessModes:
    - ReadWriteOnce
